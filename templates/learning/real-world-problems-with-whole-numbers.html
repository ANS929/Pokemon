{% extends 'learning/base.html' %}
{% load static %}

{% block title_block %}
Real-World Problems with Whole Numbers
{% endblock %}
{% block body_block %}
<style>
    .details {
        font-size: 28px;
        flex: 1;
        border: 5px solid #316cbc;
        padding: 25px;
        margin: 20px;
        height: auto;
    }

    .content {
        flex: 2;
        display: flex;
        flex-direction: column;
        border: 5px solid #ffcb13;
        padding: 25px;
        margin: 20px;
    }

    .lesson-container {
        display: flex;
        font-size: 20px;
        align-items: flex-start;
    }

    .details h1 {
        text-align: center;
    }

    .imgcontainer {
        max-width: 100%;
        padding: 10px;
        margin-left: 0;
    }

    .imgcontainer .image-container {
        display: flex;
        gap: 15px;
        justify-content: flex-start;
        align-items: flex-start;
    }

    .imgcontainer .image-container .image {
        height: 345px;
        width: 247.5px;
        border: 10px solid #fff;
        box-shadow: 0 5px 15px rgba(0, 0, 0, .1);
        overflow: hidden;
        cursor: pointer;
    }

    .imgcontainer .image-container .image img {
        height: 100%;
        width: 100%;
        object-fit: cover;
        transition: .2s linear;
    }

    .imgcontainer .image-container .image:hover {
        transform: scale(1.1)
    }

    .imgcontainer .popup-image {
        position: fixed;
        top: 0;
        left: 0;
        background: rgba(0, 0, 0, .9);
        height: 100%;
        width: 100%;
        z-index: 100;
        display: none;
    }

    .imgcontainer .popup-image span {
        position: absolute;
        top: 0;
        right: 10px;
        font-size: 10px;
        font-weight: bolder;
        color: #fff;
        cursor: pointer;
        z-index: 100;
    }

    .imgcontainer .popup-image img {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        border: 5px solid #fff;
        border-radius: 5px;
        width: 750px;
        object-fit: cover;
    }

    @media (max-width:768px) {
        .imgcontainer .popup-image img {
            width: 95%;
        }
    }
</style>
<header>
    <h1>Real-World Problems with Whole Numbers</h1>
</header>
<div class="lesson-container">
    <div class="content">
        <main>
            <section>
                <h2>Introduction:</h2>
                <p>We can solve real-world problems by using addition and subtraction.</p>
            </section>

            <section>
                <h2>Addition:</h2>
                <p>We will use the same skills discussed in the <a
                        href="{% url 'learning:practice_detail' practice_slug='addition-and-subtraction-of-whole-numbers' %}">Addition
                        and Subtraction of Whole Numbers</a> lesson in the <a
                        href="{% url 'learning:unit_detail' unit_slug='computation' %}">Computation</a> unit, but now we
                    will apply them to real-world problems.</p>
                <p><u>Example</u>: Your are battling your friend. Your active Pokémon has two attacks, one that does 150
                    damage and one that does 200 damage. If you use the first attack on one turn and the second attack
                    on another turn, how much damage will you do in total?</p>
            </section>

            <section>
                <h2>Subtraction:</h2>
                <p>We will use the same skills discussed in the <a
                        href="{% url 'learning:practice_detail' practice_slug='addition-and-subtraction-of-whole-numbers' %}">Addition
                        and Subtraction of Whole Numbers</a> lesson in the <a
                        href="{% url 'learning:unit_detail' unit_slug='computation' %}">Computation</a> unit, but now we
                    will apply them to real-world problems.</p>
                <p><u>Example</u>: Your active Pokémon has 240 HP. Your opponent attacks your Pokémon for 230 damage.
                    What is your active Pokémon's remaining HP?</p>
            </section>

            <section>
                <h2>You Try:</h2>
                <p> Your opponent attacks your Iron Leaves ex with Raging Bolt ex's Bellowing Thunder, discarding 3
                    Basic Energy. Your opponent claims this is enough damage to knock out your Iron Leaves, but you
                    disagree. How many hit points does your Iron Leaves have left after the attack? <b>Click on a card
                        to view it in a larger size</b>.</p>

                <p><u>Check your answer using the "Check Answer" button. Once you have the correct answer, submit the
                        practice using the "Submit Practice" button.</u></p>

                <div class="imgcontainer">
                    <div class="image-container">
                        <div class="image"><img src="{% static 'images/IronLeaves.png' %}" alt=""></div>
                        <div class="image"><img src="{% static 'images/RagingBolt.png' %}" alt=""></div>
                    </div>

                    <div class="popup-image">
                        <span>&times;</span>
                        <img src="" alt="" />
                    </div>
                </div>
                <br>
                <!-- practice submission and feedback -->
                <form id="practice-form" onsubmit="checkAnswer(event)"
                    action="{% url 'learning:submit_practice' practice.slug %}" method="post">
                    {% csrf_token %}
                    <label for="remainingHP"><b>Iron Leaves' remaining HP</b></label>
                    <input type="number" min="0" id="remainingHP" name="remainingHP" style="width: 100px;" required>
                    <input type="submit" value="Check Answer" id="submitBtn">
                </form>
                <p id="feedback"></p>
                <form id="final-form" method="post" action="{% url 'learning:submit_practice' practice.slug %}"
                    style="display: none;">
                    {% csrf_token %}
                    <input type="hidden" name="correct" value="True">
                    <button type="submit">Submit Practice</button>
                </form>
            </section>
        </main>
    </div>
    <div class="details">
        <h1>Algebraic Thinking Content</h1>
        <ul>
            <li><a href="{% url 'learning:practice_detail' practice_slug='real-world-problems-with-whole-numbers' %}">Real-World
                    Problems with Whole Numbers</a></li>
            <li><a href="{% url 'learning:practice_detail' practice_slug='real-world-problems-with-fractions' %}">Real-World
                    Problems with Fractions</a></li>
            <li><a href="{% url 'learning:quiz_detail' quiz_slug='algebraic-thinking-quiz' %}">Algebraic Thinking
                    Quiz</a></li>
        </ul>
    </div>

    <script>
        function checkAnswer(event) {
            event.preventDefault(); // prevent default form submission

            var remainingHP = document.getElementById('remainingHP').value.trim();
            var correctAnswer = 10;
            var feedback = document.getElementById('feedback');
            var inputField = document.getElementById('remainingHP');
            var submitButton = document.getElementById('submitBtn');
            var finalForm = document.getElementById('final-form'); // form to submit once the answer is correct

            // check for correct answer and provide feedback
            if (parseInt(remainingHP) === correctAnswer) {
                feedback.textContent = 'Correct! 70 * 3 = 210 and 220 - 210 = 10. Well done!';
                inputField.disabled = true; // disable input field
                submitButton.disabled = true; // disable submit button
                finalForm.style.display = 'block'; // show the final submission form
            } else {
                feedback.textContent = 'Incorrect. Please try again.';
            }
        }

        // Function to handle popup image display
        document.querySelectorAll(".image img").forEach(image => {
            image.onclick = () => {
                document.querySelector(".popup-image").style.display = "block";
                document.querySelector(".popup-image img").src = image.getAttribute("src");
            };
        });

        // Close the popup when clicking outside the image
        document.querySelector(".popup-image").onclick = (event) => {
            if (event.target.classList.contains('popup-image')) {
                document.querySelector(".popup-image").style.display = "none";
            }
        };
    </script>
</div><br>
{% endblock %}